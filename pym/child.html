<!DOCTYPE html>
<head>
<title>Child page</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

</head>

<body>
    <h2>Child</h2>
    <img src="https://placeimg.com/1000/600/any" alt="a random image for your enjoyment" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pym/1.3.2/pym.v1.min.js" integrity="sha512-r9Lkp17W1SL2G2lQ2quMiEEX9z2ZsUsQ0xrrnzjb/BRawjdYduOncVWDgQl6zah6BBjBE5/X3HaWevrb+puiSw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>

    /* Wait 3 seconds to simulate load and then send loaded message */
    //window.setTimeout(sendLoadedMessage, 3000);

    var pymChild;

    document.onreadystatechange = function () {
        if (document.readyState === 'interactive') {
            pymChild = new pym.Child({polling:500});
        }

        if (document.readyState === 'complete' && pymChild) {
            sendLoadedMessage();
        }
    }

    function sendLoadedMessage() {
        console.log('sending');
        pymChild.sendMessage('loaded');
    }


    /* Brief version: */

    /*
    document.onreadystatechange = function () {
        if (document.readyState === 'complete') {
            pymChild.sendMessage('loaded');
        }
    }
    */

    </script>
    </body>
    </html>